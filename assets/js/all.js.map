{"version":3,"sources":["all.js"],"names":["constraints","presence","message","url","schemes","numericality","greaterThan","greaterThanOrEqualTo","lessThanOrEqualTo","data","ticketForm","document","querySelector","ticketInputs","querySelectorAll","ticketName","getElementById","ticketImgUrl","ticketRegion","ticketPrice","ticketNum","ticketRate","ticketDescription","addTicketBtn","searchSelect","searchText","cardList","addEventListener","addTicket","filterArea","getData","axios","get","then","res","renderSelect","renderCard","renderC3","alert","renderData","cardStr","forEach","item","imgUrl","area","rate","name","description","group","price","innerHTML","e","preventDefault","value","target","newData","filter","length","nextElementSibling","textContent","errors","validate","Object","keys","errItem","ticket","id","Date","now","Number","push","reset","renderArea","selectStr","areaArray","indexOf","c3Data","total","undefined","array","chart","c3","generate","bindto","columns","type","colors","donut","title","label","show","width","size","height","init"],"mappings":"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","file":"all.js","sourcesContent":["//  表格驗證 (第七周助教直播)\nconst constraints = {\n  '套票名稱': {\n    presence: {\n      message: '是必填欄位'\n    },\n  },\n  '圖片網址':{\n    presence: {\n      message: '是必填欄位'\n    },\n    url: {\n      schemes: ['http', 'https'],\n      //  或使用 allowDataUrl: true,\n      message: '必須是正確的網址'\n    }\n  },\n  '景點地區':{\n    presence: {\n      message: '是必填欄位'\n    },\n  },\n  '套票金額':{\n    presence: {\n      message: '是必填欄位'\n    },\n    numericality: {\n      greaterThan: 0,\n      message: '必須大於 0'\n    }\n  },\n  '套票組數':{\n    presence: {\n      message: '是必填欄位'\n    },\n    numericality: {\n      greaterThan: 0,\n      message: '必須大於 0'\n    }\n  },\n  '套票星級':{\n    presence: {\n      message: '是必填欄位'\n    },\n    numericality: {\n      greaterThanOrEqualTo: 1,\n      lessThanOrEqualTo: 10,\n      message: '必須符合 1-10 的區間'\n    }\n  },\n  '套票描述':{\n    presence: {\n      message: '是必填欄位'\n    },\n  },\n};\n\n\n//  data\nlet data = [];\n\n//  DOM\n//    選取 id 用 getElementById   //  選取 class 用 querySelector\n//    querySelectorAll 把同樣的元素選起來外，會以陣列的方式被傳回\n//      新增表單\nconst ticketForm = document.querySelector('.ticketForm');\n//      驗證\nconst ticketInputs = document.querySelectorAll('input[type=text], input[type=number], .ticketForm select, textarea');\n//      新增表單-input\nconst ticketName = document.getElementById('ticketName');\nconst ticketImgUrl = document.getElementById('ticketImgUrl');\nconst ticketRegion = document.getElementById('ticketRegion');\nconst ticketPrice = document.getElementById('ticketPrice');\nconst ticketNum = document.getElementById('ticketNum');\nconst ticketRate = document.getElementById('ticketRate');\nconst ticketDescription = document.getElementById('ticketDescription');\n//      新增表單按鈕\nconst addTicketBtn = document.querySelector('.addTicketBtn');\n//      搜尋欄\nconst searchSelect = document.querySelector('.searchSelect');\n//      搜尋筆數\nconst searchText = document.querySelector('.searchText');\n//      套票卡片區\nconst cardList = document.querySelector('.cardList');\n\n\n//  監聽\n//      監聽點擊新增表單按鈕\naddTicketBtn.addEventListener('click', addTicket);\n//      監聽改選搜尋欄內容\nsearchSelect.addEventListener('change', filterArea);\n\n\n//  取得遠端資料\nfunction getData() {\n  // LV2 資料\n  axios.get('https://raw.githubusercontent.com/hexschool/js-training/main/travelApi.json')\n    .then((res) => {        //  res -- response\n      data = res.data.data;\n      //  渲染選單\n      renderSelect(data);\n      //  渲染卡片\n      renderCard(data);\n      // 渲染C3\n      renderC3(data);\n    })\n    .catch(() => {\n      alert('錯誤');\n    })\n}\n\n\n//  渲染卡片\nfunction renderCard(renderData) {\n  //  預設資料\n  let cardStr = '';\n\n  //  把資料迴圈產生卡片內容\n  renderData.forEach( (item) => {\n    cardStr += `\n      <li class=\"col\">\n        <a class=\"card h-100 shadow\" href=\"#\">\n          <div class=\"cardImg position-relative\" style=\"background-image: url(${item.imgUrl})\">                 \n            <div class=\"position-absolute top-0 start-0 translate-middle-y bg-primary-light px-9 py-3 text-white fs-7\">${item.area}</div>\n            <div class=\"position-absolute top-100 start-0 translate-middle-y bg-primary px-3 py-2 text-center text-white\">${item.rate}</div>          \n          </div>\n          <div class=\"card-body\">\n            <h3 class=\"card-title border-bottom border-primary border-2 fs-5 fw-bolder\">\n              ${item.name}\n            </h3>\n            <p class=\"cardDescription mb-15 text-secondary-light lh-lg\">\n              ${item.description}\n            </p>\n            <div class=\"d-flex justify-content-between align-items-center text-primary fw-bolder\">\n              <p >\n                <i class=\"bi bi-exclamation-circle-fill\"></i>\n                剩下最後 ${item.group} 組\n              </p>\n              <p class=\"d-flex justify-content-between align-items-center\">\n                <span class=\"me-3 fw-bold\">TWD</span>\n                <span class=\"fs-3\">$${item.price}</span>\n              </p>\n            </div>\n          </div>\n        </a>\n      </li>\n    `;\n  });\n\n  // 渲染到卡片列表\n  cardList.innerHTML = cardStr;\n};\n\n\n//  篩選地區\nfunction filterArea(e) {\n  //  取消事件的預設行為\n  e.preventDefault();\n  //  取得篩選地區\n  const value = e.target.value;\n  //  預設資料\n  let newData = [];\n  \n  //  判斷篩選區域\n  if (value == '') {\n    newData = data;\n  } else {\n    newData = data.filter( (item) => {\n      return item.area == value;\n    });\n    //  newData = data.filter(item => item.area == value); => 簡寫\n  }\n\n  //  顯示本次搜尋筆數\n  searchText.innerHTML = `本次搜尋共 ${newData.length} 筆資料`;\n  \n  // 渲染卡片\n  renderCard(newData);\n};\n\n\n//  新增卡片\nfunction addTicket(e) {\n  //  取消事件的預設行為\n  e.preventDefault();\n\n  // 清空表格錯誤訊息\n  ticketInputs.forEach( (item) => {  \n    // item 為表格，item.nextElementSibling 是表格下方的 <small>\n    item.nextElementSibling.textContent = '';\n  })\n\n  // 驗證表單\n  const errors = validate(ticketForm, constraints);\n\n  // 如果驗證錯誤\n  if (errors) {\n    // 渲染錯誤訊息\n    // Object.keys() => 取得物件所有屬性，並組成陣列\n    Object.keys(errors).forEach( (errItem) => {\n      document.querySelector(`.${errItem}`).textContent = errors[errItem];\n    })\n  } else {\n    // 取得新卡片資料\n    const ticket = {\n      id: Date.now(),   //取得目前時間(毫秒) 時間戳 timestamp\n      name: ticketName.value,\n      imgUrl: ticketImgUrl.value,\n      area: ticketRegion.value,\n      description: ticketDescription.value,\n      group: Number(ticketNum.value),\n      price: Number(ticketPrice.value),\n      rate: Number(ticketRate.value),\n    };\n\n    // 把新資料加入 data 中\n    data.push(ticket);\n\n    // 渲染卡片\n    renderCard(data);\n\n    //  渲染下拉地區選單\n    // renderSelect(data);    \n    searchSelect.value = '';\n    searchText.textContent = '';\n\n    //  渲染 C3 圖表\n    renderC3(data);\n\n    // 清空表格\n    ticketForm.reset();\n  }\n};\n\n   \n//  //  額外東西\n// 渲染下拉地區選單\nfunction renderSelect(renderArea) {\n  // 預設資料\n  let selectStr = '<option value=\"\" disabled selected hidden>地區搜尋</option><option value=\"\">全部地區</option>';\n  const areaArray = [];\n\n  // 取得不重複地區\n  renderArea.forEach( (item) => {\n    if (areaArray.indexOf(item.area) == -1) {\n      areaArray.push(item.area);\n    }\n  })\n\n  // 把資料迴圈產生選單內容\n  areaArray.forEach( (item) => {\n    selectStr += `\n      <option value=\"${item}\">${item}</option>\n    `;\n  })\n\n  // 渲染到下拉選單\n  searchSelect.innerHTML = selectStr;\n};\n\n// 渲染 C3 圖表\nfunction renderC3(c3Data) {\n  // step1：將資料整理成 => [['高雄', 1], ['台中', 2], ['台北', 1]]\n\n  // {\n  //   '高雄': 1,\n  //   '台中': 2,\n  //   '台北': 2,\n  // }\n  // step1-1：蒐集資料\n  const total = {};\n  c3Data.forEach((item) => {\n    if (total[item.area] == undefined) {\n      total[item.area] = 1;\n    } else {\n      total[item.area] += 1;\n    }\n  });\n  \n  // step1-2：處理資料\n  // Object.keys(total) => ['高雄', '台中', '台北']\n\n  const newData = [];\n  Object.keys(total).forEach((item) => {\n    const array = [\n      item, total[item]\n    ];\n    newData.push(array);\n  });\n\n  // step2：把整理後的資料套用至 C3.js\n  const chart = c3.generate({\n    // 綁定 id 名稱\n    bindto: '#chart',\n    data: {\n      // 圖表數據\n      columns: newData,\n      // 圖表類型\n      type: 'donut',\n      // 圖表色塊顏色\n      colors: {\n        '台北': '#dc3545',\n        '台中': '#6f42c1',\n        '高雄': '#ffc107',\n      },\n    },\n    donut: {\n      // 標題\n      title: '套票地區比重',\n      label: {\n        // 資料圈圈數字是否顯示\n        show: false,\n      },\n      // 資料圈圈寬度\n      width: 15,\n    },\n    // 圖表尺寸\n    size: {\n      width: 160,\n      height: 160,\n    },\n  });\n}\n\n\n// 初始化\nfunction init() {\n  // 取得遠端資料\n  getData();\n}\n\ninit();"]}